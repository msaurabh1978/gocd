<div id="ssh_private_key_div" class="form_item_block">
  <label>SSH Private Key</label>
  <%= scope[:form].hidden_field(com.thoughtworks.go.config.materials.git.GitMaterialConfig::ENCRYPTED_SSH_PRIVATE_KEY, {:class => "form_input encrypted_password"}) -%>
  <%= scope[:form].text_area(com.thoughtworks.go.config.materials.git.GitMaterialConfig::SSH_PRIVATE_KEY, {:class => "form_input sshPrivateKey",  disabled: 'disabled', :style => 'height: 100px; display: inline; width: 200px; background-color: #e6e6e6; margin-bottom:5px !important'}) -%>


  <% if(scope[:form].object.errors[com.thoughtworks.go.config.materials.git.GitMaterialConfig::SSH_PRIVATE_KEY].present?) %>
    <%
      bottomStyle = 'bottom: -35px;'
    %>
    <div style="position: relative; bottom: -35px">
      <%= error_message_on(scope[:form].object, com.thoughtworks.go.config.materials.git.GitMaterialConfig::SSH_PRIVATE_KEY, :css_class => "form_error") %>
    </div>
  <% else %>
    <%
      bottomStyle = 'bottom: 53px;'
    %>
  <% end %>

    <div class="checkbox_row" style="display: inline; position: relative; <%= bottomStyle %>">
    <%= check_box_tag("material[#{com.thoughtworks.go.config.materials.git.GitMaterialConfig::SSH_PRIVATE_KEY_CHANGED}]", "1", false, :class => "password_changed") %>
    <label class="condition" for="material_<%= com.thoughtworks.go.config.materials.git.GitMaterialConfig::SSH_PRIVATE_KEY_CHANGED -%>">Change Private Key</label>
  </div>
</div>

<script type="text/javascript">
   var checkBox = jQuery("#material_<%= com.thoughtworks.go.config.materials.git.GitMaterialConfig::SSH_PRIVATE_KEY_CHANGED -%>");
   var privateKeyField = jQuery("#material_<%=com.thoughtworks.go.config.materials.git.GitMaterialConfig::SSH_PRIVATE_KEY -%>");

   Util.on_load(function() {
     bindCheckBoxToAField(checkBox, privateKeyField);
   });

   function bindCheckBoxToAField(checkBox, elm) {
     elm.val("**********");

     checkBox.click(function() {
       var isChecked = checkBox.is(":checked");
       if (isChecked) {
         elm.removeAttr("disabled");
         elm.val("");
         elm.css('background-color', 'white');
       } else {
         elm.attr("disabled", true);
         elm.val("**********");
         elm.css('background-color', '#e6e6e6');
       }
     });
   }
</script>
